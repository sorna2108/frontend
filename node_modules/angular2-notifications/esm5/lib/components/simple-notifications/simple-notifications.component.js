import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '../../services/notifications.service';
import * as ɵngcc2 from '@angular/common';
import * as ɵngcc3 from '../notification/notification.component';

function SimpleNotificationsComponent_simple_notification_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "simple-notification", 2);
} if (rf & 2) {
    var a_r1 = ctx.$implicit;
    var i_r2 = ctx.index;
    var ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("item", a_r1)("timeOut", ctx_r0.timeOut)("clickToClose", ctx_r0.clickToClose)("clickIconToClose", ctx_r0.clickIconToClose)("maxLength", ctx_r0.maxLength)("showProgressBar", ctx_r0.showProgressBar)("pauseOnHover", ctx_r0.pauseOnHover)("theClass", ctx_r0.theClass)("rtl", ctx_r0.rtl)("animate", ctx_r0.animate)("position", i_r2);
} }
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __values = (this && this.__values) || function(o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
};
import { ChangeDetectionStrategy, Component, EventEmitter, Input, OnDestroy, OnInit, Output, ViewEncapsulation, ChangeDetectorRef, ViewRef } from '@angular/core';
import { NotificationAnimationType } from '../../enums/notification-animation-type.enum';
import { NotificationsService } from '../../services/notifications.service';
var SimpleNotificationsComponent = /** @class */ (function () {
    function SimpleNotificationsComponent(service, cd) {
        this.service = service;
        this.cd = cd;
        this.create = new EventEmitter();
        this.destroy = new EventEmitter();
        this.notifications = [];
        this.position = ['bottom', 'right'];
        // Received values
        this.lastOnBottom = true;
        this.maxStack = 8;
        this.preventLastDuplicates = false;
        this.preventDuplicates = false;
        // Sent values
        this.timeOut = 0;
        this.maxLength = 0;
        this.clickToClose = true;
        this.clickIconToClose = false;
        this.showProgressBar = true;
        this.pauseOnHover = true;
        this.theClass = '';
        this.rtl = false;
        this.animate = NotificationAnimationType.FromRight;
        this.usingComponentOptions = false;
    }
    Object.defineProperty(SimpleNotificationsComponent.prototype, "options", {
        set: function (opt) {
            this.usingComponentOptions = true;
            this.attachChanges(opt);
        },
        enumerable: true,
        configurable: true
    });
    SimpleNotificationsComponent.prototype.ngOnInit = function () {
        var _this = this;
        /**
         * Only attach global options if config
         * options were never sent through input
         */
        if (!this.usingComponentOptions) {
            this.attachChanges(this.service.globalOptions);
        }
        this.listener = this.service.emitter
            .subscribe(function (item) {
            switch (item.command) {
                case 'cleanAll':
                    _this.notifications = [];
                    break;
                case 'clean':
                    _this.cleanSingle(item.id);
                    break;
                case 'set':
                    if (item.add) {
                        _this.add(item.notification);
                    }
                    else {
                        _this.defaultBehavior(item);
                    }
                    break;
                default:
                    _this.defaultBehavior(item);
                    break;
            }
            if (!_this.cd.destroyed) {
                _this.cd.detectChanges();
            }
        });
    };
    SimpleNotificationsComponent.prototype.ngOnDestroy = function () {
        if (this.listener) {
            this.listener.unsubscribe();
        }
        this.cd.detach();
    };
    // Default behavior on event
    SimpleNotificationsComponent.prototype.defaultBehavior = function (value) {
        this.notifications.splice(this.notifications.indexOf(value.notification), 1);
        this.destroy.emit(this.buildEmit(value.notification, false));
    };
    // Add the new notification to the notification array
    SimpleNotificationsComponent.prototype.add = function (item) {
        item.createdOn = new Date();
        var toBlock = this.preventLastDuplicates || this.preventDuplicates ? this.block(item) : false;
        // Save this as the last created notification
        this.lastNotificationCreated = item;
        // Override icon if set
        if (item.override && item.override.icons && item.override.icons[item.type]) {
            item.icon = item.override.icons[item.type];
        }
        if (!toBlock) {
            // Check if the notification should be added at the start or the end of the array
            if (this.lastOnBottom) {
                if (this.notifications.length >= this.maxStack) {
                    this.notifications.splice(0, 1);
                }
                this.notifications.push(item);
            }
            else {
                if (this.notifications.length >= this.maxStack) {
                    this.notifications.splice(this.notifications.length - 1, 1);
                }
                this.notifications.splice(0, 0, item);
            }
            this.create.emit(this.buildEmit(item, true));
        }
    };
    // Check if notifications should be prevented
    SimpleNotificationsComponent.prototype.block = function (item) {
        var e_1, _a;
        var toCheck = item.html ? this.checkHtml : this.checkStandard;
        if (this.preventDuplicates && this.notifications.length > 0) {
            try {
                for (var _b = __values(this.notifications), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var notification = _c.value;
                    if (toCheck(notification, item)) {
                        return true;
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
        if (this.preventLastDuplicates) {
            var comp = void 0;
            if (this.preventLastDuplicates === 'visible' && this.notifications.length > 0) {
                if (this.lastOnBottom) {
                    comp = this.notifications[this.notifications.length - 1];
                }
                else {
                    comp = this.notifications[0];
                }
            }
            else if (this.preventLastDuplicates === 'all' && this.lastNotificationCreated) {
                comp = this.lastNotificationCreated;
            }
            else {
                return false;
            }
            return toCheck(comp, item);
        }
        return false;
    };
    SimpleNotificationsComponent.prototype.checkStandard = function (checker, item) {
        return checker.type === item.type && checker.title === item.title && checker.content === item.content;
    };
    SimpleNotificationsComponent.prototype.checkHtml = function (checker, item) {
        return checker.html ?
            checker.type === item.type && checker.title === item.title && checker.content === item.content && checker.html === item.html :
            false;
    };
    // Attach all the changes received in the options object
    SimpleNotificationsComponent.prototype.attachChanges = function (options) {
        for (var key in options) {
            if (this.hasOwnProperty(key)) {
                this[key] = options[key];
            }
            else if (key === 'icons') {
                this.service.icons = options[key];
            }
        }
    };
    SimpleNotificationsComponent.prototype.buildEmit = function (notification, to) {
        var toEmit = {
            createdOn: notification.createdOn,
            type: notification.type,
            icon: notification.icon,
            id: notification.id
        };
        if (notification.html) {
            toEmit.html = notification.html;
        }
        else {
            toEmit.title = notification.title;
            toEmit.content = notification.content;
        }
        if (!to) {
            toEmit.destroyedOn = new Date();
        }
        return toEmit;
    };
    SimpleNotificationsComponent.prototype.cleanSingle = function (id) {
        var indexOfDelete = 0;
        var doDelete = false;
        var noti;
        this.notifications.forEach(function (notification, idx) {
            if (notification.id === id) {
                indexOfDelete = idx;
                noti = notification;
                doDelete = true;
            }
        });
        if (doDelete) {
            this.notifications.splice(indexOfDelete, 1);
            this.destroy.emit(this.buildEmit(noti, false));
        }
    };
    SimpleNotificationsComponent.ctorParameters = function () { return [
        { type: NotificationsService },
        { type: ChangeDetectorRef }
    ]; };
    __decorate([
        Input()
    ], SimpleNotificationsComponent.prototype, "options", null);
    __decorate([
        Output()
    ], SimpleNotificationsComponent.prototype, "create", void 0);
    __decorate([
        Output()
    ], SimpleNotificationsComponent.prototype, "destroy", void 0);
SimpleNotificationsComponent.ɵfac = function SimpleNotificationsComponent_Factory(t) { return new (t || SimpleNotificationsComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.NotificationsService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef)); };
SimpleNotificationsComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: SimpleNotificationsComponent, selectors: [["simple-notifications"]], inputs: { options: "options" }, outputs: { create: "create", destroy: "destroy" }, decls: 2, vars: 2, consts: [[1, "simple-notification-wrapper", 3, "ngClass"], [3, "item", "timeOut", "clickToClose", "clickIconToClose", "maxLength", "showProgressBar", "pauseOnHover", "theClass", "rtl", "animate", "position", 4, "ngFor", "ngForOf"], [3, "item", "timeOut", "clickToClose", "clickIconToClose", "maxLength", "showProgressBar", "pauseOnHover", "theClass", "rtl", "animate", "position"]], template: function SimpleNotificationsComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "div", 0);
        ɵngcc0.ɵɵtemplate(1, SimpleNotificationsComponent_simple_notification_1_Template, 1, 11, "simple-notification", 1);
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("ngClass", ctx.position);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngForOf", ctx.notifications);
    } }, directives: [ɵngcc2.NgClass, ɵngcc2.NgForOf, ɵngcc3.NotificationComponent], styles: [".simple-notification-wrapper{position:fixed;width:300px;z-index:1000}.simple-notification-wrapper.left{left:20px}.simple-notification-wrapper.top{top:20px}.simple-notification-wrapper.right{right:20px}.simple-notification-wrapper.bottom{bottom:20px}.simple-notification-wrapper.center{left:50%;transform:translateX(-50%)}.simple-notification-wrapper.middle{top:50%;transform:translateY(-50%)}.simple-notification-wrapper.middle.center{transform:translate(-50%,-50%)}@media (max-width:340px){.simple-notification-wrapper{width:auto;left:20px;right:20px}}"], encapsulation: 2, changeDetection: 0 });
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(SimpleNotificationsComponent, [{
        type: Component,
        args: [{
                selector: 'simple-notifications',
                encapsulation: ViewEncapsulation.None,
                template: "<div class=\"simple-notification-wrapper\" [ngClass]=\"position\">\r\n    <simple-notification\r\n            *ngFor=\"let a of notifications; let i = index\"\r\n            [item]=\"a\"\r\n            [timeOut]=\"timeOut\"\r\n            [clickToClose]=\"clickToClose\"\r\n            [clickIconToClose]=\"clickIconToClose\"\r\n            [maxLength]=\"maxLength\"\r\n            [showProgressBar]=\"showProgressBar\"\r\n            [pauseOnHover]=\"pauseOnHover\"\r\n            [theClass]=\"theClass\"\r\n            [rtl]=\"rtl\"\r\n            [animate]=\"animate\"\r\n            [position]=\"i\">\r\n    </simple-notification>\r\n</div>",
                changeDetection: ChangeDetectionStrategy.OnPush,
                styles: [".simple-notification-wrapper{position:fixed;width:300px;z-index:1000}.simple-notification-wrapper.left{left:20px}.simple-notification-wrapper.top{top:20px}.simple-notification-wrapper.right{right:20px}.simple-notification-wrapper.bottom{bottom:20px}.simple-notification-wrapper.center{left:50%;transform:translateX(-50%)}.simple-notification-wrapper.middle{top:50%;transform:translateY(-50%)}.simple-notification-wrapper.middle.center{transform:translate(-50%,-50%)}@media (max-width:340px){.simple-notification-wrapper{width:auto;left:20px;right:20px}}"]
            }]
    }], function () { return [{ type: ɵngcc1.NotificationsService }, { type: ɵngcc0.ChangeDetectorRef }]; }, { create: [{
            type: Output
        }], destroy: [{
            type: Output
        }], options: [{
            type: Input
        }] }); })();
    return SimpleNotificationsComponent;
}());
export { SimpleNotificationsComponent };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2ltcGxlLW5vdGlmaWNhdGlvbnMuY29tcG9uZW50LmpzIiwic291cmNlcyI6WyJhbmd1bGFyMi1ub3RpZmljYXRpb25zL2xpYi9jb21wb25lbnRzL3NpbXBsZS1ub3RpZmljYXRpb25zL3NpbXBsZS1ub3RpZmljYXRpb25zLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsaUJBQWlCLEVBQUUsaUJBQWlCLEVBQUUsT0FBTyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRWxLLE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxNQUFNLDhDQUE4QyxDQUFDO0FBR3pGLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLHNDQUFzQyxDQUFDO0FBUzVFO0FBQWdFLElBQzlELHNDQUNVLE9BQTZCLEVBQzdCLEVBQXFCO0FBQzlCLFFBRlMsWUFBTyxHQUFQLE9BQU8sQ0FBc0I7QUFBQyxRQUM5QixPQUFFLEdBQUYsRUFBRSxDQUFtQjtBQUNqQyxRQU9ZLFdBQU0sR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO0FBQ3hDLFFBQVksWUFBTyxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7QUFDekMsUUFDRSxrQkFBYSxHQUFtQixFQUFFLENBQUM7QUFDckMsUUFBRSxhQUFRLEdBQWEsQ0FBQyxRQUFRLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDM0MsUUFJRSxrQkFBa0I7QUFDcEIsUUFBVSxpQkFBWSxHQUFHLElBQUksQ0FBQztBQUM5QixRQUFVLGFBQVEsR0FBRyxDQUFDLENBQUM7QUFDdkIsUUFBVSwwQkFBcUIsR0FBUSxLQUFLLENBQUM7QUFDN0MsUUFBVSxzQkFBaUIsR0FBRyxLQUFLLENBQUM7QUFDcEMsUUFDRSxjQUFjO0FBQ2hCLFFBQUUsWUFBTyxHQUFHLENB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LEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQWpDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBOEJBLEFBQUEsQUFBQSxBQUFBLEFBdUNBLEFBckNBLEFBR0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUVBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFHQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFDQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUEzTkEsQUFBQSxBQUNBLEFBQUEsQUFHQSxBQUFBLEFBQUEsQUFBQSxBQUdBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFaQSxBQUFBLEFBUEEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUE4TkEsQUFBQSxBQUFBLEFBQUEsQUE5TkEsQUE4TkEsQUE5TkEsQUFBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENoYW5nZURldGVjdGlvblN0cmF0ZWd5LCBDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE9uRGVzdHJveSwgT25Jbml0LCBPdXRwdXQsIFZpZXdFbmNhcHN1bGF0aW9uLCBDaGFuZ2VEZXRlY3RvclJlZiwgVmlld1JlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgTm90aWZpY2F0aW9uQW5pbWF0aW9uVHlwZSB9IGZyb20gJy4uLy4uL2VudW1zL25vdGlmaWNhdGlvbi1hbmltYXRpb24tdHlwZS5lbnVtJztcclxuaW1wb3J0IHsgTm90aWZpY2F0aW9uIH0gZnJvbSAnLi4vLi4vaW50ZXJmYWNlcy9ub3RpZmljYXRpb24udHlwZSc7XHJcbmltcG9ydCB7IE9wdGlvbnMsIFBvc2l0aW9uIH0gZnJvbSAnLi4vLi4vaW50ZXJmYWNlcy9vcHRpb25zLnR5cGUnO1xyXG5pbXBvcnQgeyBOb3RpZmljYXRpb25zU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL25vdGlmaWNhdGlvbnMuc2VydmljZSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ3NpbXBsZS1ub3RpZmljYXRpb25zJyxcclxuICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9zaW1wbGUtbm90aWZpY2F0aW9ucy5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vc2ltcGxlLW5vdGlmaWNhdGlvbnMuY29tcG9uZW50LmNzcyddLFxyXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBTaW1wbGVOb3RpZmljYXRpb25zQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3kge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSBzZXJ2aWNlOiBOb3RpZmljYXRpb25zU2VydmljZSxcclxuICAgIHByaXZhdGUgY2Q6IENoYW5nZURldGVjdG9yUmVmXHJcbiAgKSB7IH1cclxuXHJcbiAgQElucHV0KCkgc2V0IG9wdGlvbnMob3B0OiBPcHRpb25zKSB7XHJcbiAgICB0aGlzLnVzaW5nQ29tcG9uZW50T3B0aW9ucyA9IHRydWU7XHJcbiAgICB0aGlzLmF0dGFjaENoYW5nZXMob3B0KTtcclxuICB9XHJcblxyXG4gIEBPdXRwdXQoKSBjcmVhdGUgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgQE91dHB1dCgpIGRlc3Ryb3kgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gIG5vdGlmaWNhdGlvbnM6IE5vdGlmaWNhdGlvbltdID0gW107XHJcbiAgcG9zaXRpb246IFBvc2l0aW9uID0gWydib3R0b20nLCAncmlnaHQnXTtcclxuXHJcbiAgcHJpdmF0ZSBsYXN0Tm90aWZpY2F0aW9uQ3JlYXRlZDogTm90aWZpY2F0aW9uO1xyXG4gIHByaXZhdGUgbGlzdGVuZXI6IFN1YnNjcmlwdGlvbjtcclxuXHJcbiAgLy8gUmVjZWl2ZWQgdmFsdWVzXHJcbiAgcHJpdmF0ZSBsYXN0T25Cb3R0b20gPSB0cnVlO1xyXG4gIHByaXZhdGUgbWF4U3RhY2sgPSA4O1xyXG4gIHByaXZhdGUgcHJldmVudExhc3REdXBsaWNhdGVzOiBhbnkgPSBmYWxzZTtcclxuICBwcml2YXRlIHByZXZlbnREdXBsaWNhdGVzID0gZmFsc2U7XHJcblxyXG4gIC8vIFNlbnQgdmFsdWVzXHJcbiAgdGltZU91dCA9IDA7XHJcbiAgbWF4TGVuZ3RoID0gMDtcclxuICBjbGlja1RvQ2xvc2UgPSB0cnVlO1xyXG4gIGNsaWNrSWNvblRvQ2xvc2UgPSBmYWxzZTtcclxuICBzaG93UHJvZ3Jlc3NCYXIgPSB0cnVlO1xyXG4gIHBhdXNlT25Ib3ZlciA9IHRydWU7XHJcbiAgdGhlQ2xhc3MgPSAnJztcclxuICBydGwgPSBmYWxzZTtcclxuICBhbmltYXRlOiBOb3RpZmljYXRpb25BbmltYXRpb25UeXBlID0gTm90aWZpY2F0aW9uQW5pbWF0aW9uVHlwZS5Gcm9tUmlnaHQ7XHJcblxyXG4gIHByaXZhdGUgdXNpbmdDb21wb25lbnRPcHRpb25zID0gZmFsc2U7XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogT25seSBhdHRhY2ggZ2xvYmFsIG9wdGlvbnMgaWYgY29uZmlnXHJcbiAgICAgKiBvcHRpb25zIHdlcmUgbmV2ZXIgc2VudCB0aHJvdWdoIGlucHV0XHJcbiAgICAgKi9cclxuICAgIGlmICghdGhpcy51c2luZ0NvbXBvbmVudE9wdGlvbnMpIHtcclxuICAgICAgdGhpcy5hdHRhY2hDaGFuZ2VzKFxyXG4gICAgICAgIHRoaXMuc2VydmljZS5nbG9iYWxPcHRpb25zXHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5saXN0ZW5lciA9IHRoaXMuc2VydmljZS5lbWl0dGVyXHJcbiAgICAgIC5zdWJzY3JpYmUoaXRlbSA9PiB7XHJcbiAgICAgICAgc3dpdGNoIChpdGVtLmNvbW1hbmQpIHtcclxuICAgICAgICAgIGNhc2UgJ2NsZWFuQWxsJzpcclxuICAgICAgICAgICAgdGhpcy5ub3RpZmljYXRpb25zID0gW107XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgIGNhc2UgJ2NsZWFuJzpcclxuICAgICAgICAgICAgdGhpcy5jbGVhblNpbmdsZShpdGVtLmlkISk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgIGNhc2UgJ3NldCc6XHJcbiAgICAgICAgICAgIGlmIChpdGVtLmFkZCkge1xyXG4gICAgICAgICAgICAgIHRoaXMuYWRkKGl0ZW0ubm90aWZpY2F0aW9uISk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5kZWZhdWx0QmVoYXZpb3IoaXRlbSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgdGhpcy5kZWZhdWx0QmVoYXZpb3IoaXRlbSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoISh0aGlzLmNkIGFzIFZpZXdSZWYpLmRlc3Ryb3llZCkge1xyXG4gICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIG5nT25EZXN0cm95KCkge1xyXG4gICAgaWYgKHRoaXMubGlzdGVuZXIpIHtcclxuICAgICAgdGhpcy5saXN0ZW5lci51bnN1YnNjcmliZSgpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5jZC5kZXRhY2goKTtcclxuICB9XHJcblxyXG4gIC8vIERlZmF1bHQgYmVoYXZpb3Igb24gZXZlbnRcclxuICBkZWZhdWx0QmVoYXZpb3IodmFsdWU6IGFueSk6IHZvaWQge1xyXG4gICAgdGhpcy5ub3RpZmljYXRpb25zLnNwbGljZSh0aGlzLm5vdGlmaWNhdGlvbnMuaW5kZXhPZih2YWx1ZS5ub3RpZmljYXRpb24pLCAxKTtcclxuICAgIHRoaXMuZGVzdHJveS5lbWl0KHRoaXMuYnVpbGRFbWl0KHZhbHVlLm5vdGlmaWNhdGlvbiwgZmFsc2UpKTtcclxuICB9XHJcblxyXG5cclxuICAvLyBBZGQgdGhlIG5ldyBub3RpZmljYXRpb24gdG8gdGhlIG5vdGlmaWNhdGlvbiBhcnJheVxyXG4gIGFkZChpdGVtOiBOb3RpZmljYXRpb24pOiB2b2lkIHtcclxuICAgIGl0ZW0uY3JlYXRlZE9uID0gbmV3IERhdGUoKTtcclxuXHJcbiAgICBjb25zdCB0b0Jsb2NrOiBib29sZWFuID0gdGhpcy5wcmV2ZW50TGFzdER1cGxpY2F0ZXMgfHwgdGhpcy5wcmV2ZW50RHVwbGljYXRlcyA/IHRoaXMuYmxvY2soaXRlbSkgOiBmYWxzZTtcclxuXHJcbiAgICAvLyBTYXZlIHRoaXMgYXMgdGhlIGxhc3QgY3JlYXRlZCBub3RpZmljYXRpb25cclxuICAgIHRoaXMubGFzdE5vdGlmaWNhdGlvbkNyZWF0ZWQgPSBpdGVtO1xyXG4gICAgLy8gT3ZlcnJpZGUgaWNvbiBpZiBzZXRcclxuICAgIGlmIChpdGVtLm92ZXJyaWRlICYmIGl0ZW0ub3ZlcnJpZGUuaWNvbnMgJiYgaXRlbS5vdmVycmlkZS5pY29uc1tpdGVtLnR5cGVdKSB7XHJcbiAgICAgIGl0ZW0uaWNvbiA9IGl0ZW0ub3ZlcnJpZGUuaWNvbnNbaXRlbS50eXBlXTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIXRvQmxvY2spIHtcclxuICAgICAgLy8gQ2hlY2sgaWYgdGhlIG5vdGlmaWNhdGlvbiBzaG91bGQgYmUgYWRkZWQgYXQgdGhlIHN0YXJ0IG9yIHRoZSBlbmQgb2YgdGhlIGFycmF5XHJcbiAgICAgIGlmICh0aGlzLmxhc3RPbkJvdHRvbSkge1xyXG4gICAgICAgIGlmICh0aGlzLm5vdGlmaWNhdGlvbnMubGVuZ3RoID49IHRoaXMubWF4U3RhY2spIHtcclxuICAgICAgICAgIHRoaXMubm90aWZpY2F0aW9ucy5zcGxpY2UoMCwgMSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLm5vdGlmaWNhdGlvbnMucHVzaChpdGVtKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAodGhpcy5ub3RpZmljYXRpb25zLmxlbmd0aCA+PSB0aGlzLm1heFN0YWNrKSB7XHJcbiAgICAgICAgICB0aGlzLm5vdGlmaWNhdGlvbnMuc3BsaWNlKHRoaXMubm90aWZpY2F0aW9ucy5sZW5ndGggLSAxLCAxKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMubm90aWZpY2F0aW9ucy5zcGxpY2UoMCwgMCwgaXRlbSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMuY3JlYXRlLmVtaXQodGhpcy5idWlsZEVtaXQoaXRlbSwgdHJ1ZSkpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gQ2hlY2sgaWYgbm90aWZpY2F0aW9ucyBzaG91bGQgYmUgcHJldmVudGVkXHJcbiAgYmxvY2soaXRlbTogTm90aWZpY2F0aW9uKTogYm9vbGVhbiB7XHJcblxyXG4gICAgY29uc3QgdG9DaGVjayA9IGl0ZW0uaHRtbCA/IHRoaXMuY2hlY2tIdG1sIDogdGhpcy5jaGVja1N0YW5kYXJkO1xyXG5cclxuICAgIGlmICh0aGlzLnByZXZlbnREdXBsaWNhdGVzICYmIHRoaXMubm90aWZpY2F0aW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAoY29uc3Qgbm90aWZpY2F0aW9uIG9mIHRoaXMubm90aWZpY2F0aW9ucykge1xyXG4gICAgICAgIGlmICh0b0NoZWNrKG5vdGlmaWNhdGlvbiwgaXRlbSkpIHtcclxuICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmICh0aGlzLnByZXZlbnRMYXN0RHVwbGljYXRlcykge1xyXG5cclxuICAgICAgbGV0IGNvbXA6IE5vdGlmaWNhdGlvbjtcclxuXHJcbiAgICAgIGlmICh0aGlzLnByZXZlbnRMYXN0RHVwbGljYXRlcyA9PT0gJ3Zpc2libGUnICYmIHRoaXMubm90aWZpY2F0aW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubGFzdE9uQm90dG9tKSB7XHJcbiAgICAgICAgICBjb21wID0gdGhpcy5ub3RpZmljYXRpb25zW3RoaXMubm90aWZpY2F0aW9ucy5sZW5ndGggLSAxXTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgY29tcCA9IHRoaXMubm90aWZpY2F0aW9uc1swXTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5wcmV2ZW50TGFzdER1cGxpY2F0ZXMgPT09ICdhbGwnICYmIHRoaXMubGFzdE5vdGlmaWNhdGlvbkNyZWF0ZWQpIHtcclxuICAgICAgICBjb21wID0gdGhpcy5sYXN0Tm90aWZpY2F0aW9uQ3JlYXRlZDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHRvQ2hlY2soY29tcCwgaXRlbSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgY2hlY2tTdGFuZGFyZChjaGVja2VyOiBOb3RpZmljYXRpb24sIGl0ZW06IE5vdGlmaWNhdGlvbik6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIGNoZWNrZXIudHlwZSA9PT0gaXRlbS50eXBlICYmIGNoZWNrZXIudGl0bGUgPT09IGl0ZW0udGl0bGUgJiYgY2hlY2tlci5jb250ZW50ID09PSBpdGVtLmNvbnRlbnQ7XHJcbiAgfVxyXG5cclxuICBjaGVja0h0bWwoY2hlY2tlcjogTm90aWZpY2F0aW9uLCBpdGVtOiBOb3RpZmljYXRpb24pOiBib29sZWFuIHtcclxuICAgIHJldHVybiBjaGVja2VyLmh0bWwgP1xyXG4gICAgICBjaGVja2VyLnR5cGUgPT09IGl0ZW0udHlwZSAmJiBjaGVja2VyLnRpdGxlID09PSBpdGVtLnRpdGxlICYmIGNoZWNrZXIuY29udGVudCA9PT0gaXRlbS5jb250ZW50ICYmIGNoZWNrZXIuaHRtbCA9PT0gaXRlbS5odG1sIDpcclxuICAgICAgZmFsc2U7XHJcbiAgfVxyXG5cclxuICAvLyBBdHRhY2ggYWxsIHRoZSBjaGFuZ2VzIHJlY2VpdmVkIGluIHRoZSBvcHRpb25zIG9iamVjdFxyXG4gIGF0dGFjaENoYW5nZXMob3B0aW9uczogYW55KSB7XHJcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBvcHRpb25zKSB7XHJcbiAgICAgIGlmICh0aGlzLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuICAgICAgICAodGhpcyBhcyBhbnkpW2tleV0gPSBvcHRpb25zW2tleV07XHJcbiAgICAgIH0gZWxzZSBpZiAoa2V5ID09PSAnaWNvbnMnKSB7XHJcbiAgICAgICAgdGhpcy5zZXJ2aWNlLmljb25zID0gb3B0aW9uc1trZXldO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBidWlsZEVtaXQobm90aWZpY2F0aW9uOiBOb3RpZmljYXRpb24sIHRvOiBib29sZWFuKSB7XHJcbiAgICBjb25zdCB0b0VtaXQ6IE5vdGlmaWNhdGlvbiA9IHtcclxuICAgICAgY3JlYXRlZE9uOiBub3RpZmljYXRpb24uY3JlYXRlZE9uLFxyXG4gICAgICB0eXBlOiBub3RpZmljYXRpb24udHlwZSxcclxuICAgICAgaWNvbjogbm90aWZpY2F0aW9uLmljb24sXHJcbiAgICAgIGlkOiBub3RpZmljYXRpb24uaWRcclxuICAgIH07XHJcblxyXG4gICAgaWYgKG5vdGlmaWNhdGlvbi5odG1sKSB7XHJcbiAgICAgIHRvRW1pdC5odG1sID0gbm90aWZpY2F0aW9uLmh0bWw7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0b0VtaXQudGl0bGUgPSBub3RpZmljYXRpb24udGl0bGU7XHJcbiAgICAgIHRvRW1pdC5jb250ZW50ID0gbm90aWZpY2F0aW9uLmNvbnRlbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCF0bykge1xyXG4gICAgICB0b0VtaXQuZGVzdHJveWVkT24gPSBuZXcgRGF0ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0b0VtaXQ7XHJcbiAgfVxyXG5cclxuICBjbGVhblNpbmdsZShpZDogc3RyaW5nKTogdm9pZCB7XHJcbiAgICBsZXQgaW5kZXhPZkRlbGV0ZSA9IDA7XHJcbiAgICBsZXQgZG9EZWxldGUgPSBmYWxzZTtcclxuICAgIGxldCBub3RpO1xyXG5cclxuICAgIHRoaXMubm90aWZpY2F0aW9ucy5mb3JFYWNoKChub3RpZmljYXRpb24sIGlkeCkgPT4ge1xyXG4gICAgICBpZiAobm90aWZpY2F0aW9uLmlkID09PSBpZCkge1xyXG4gICAgICAgIGluZGV4T2ZEZWxldGUgPSBpZHg7XHJcbiAgICAgICAgbm90aSA9IG5vdGlmaWNhdGlvbjtcclxuICAgICAgICBkb0RlbGV0ZSA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChkb0RlbGV0ZSkge1xyXG4gICAgICB0aGlzLm5vdGlmaWNhdGlvbnMuc3BsaWNlKGluZGV4T2ZEZWxldGUsIDEpO1xyXG4gICAgICB0aGlzLmRlc3Ryb3kuZW1pdCh0aGlzLmJ1aWxkRW1pdChub3RpLCBmYWxzZSkpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iXX0=